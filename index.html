<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>级联演示</title>
	<!-- 引入线上layui -->
	<link href="./layui/css/layui.css" rel="stylesheet">
	<script src="./layui/layui.all.js"></script>
	<!-- 引入插件CSS样式 -->
	<link rel="stylesheet" href="./mods/ajaxCascader/ajaxCascader.css">
	<style>
		.main{
			margin: 20px;
		}
	</style>
</head>
<body>
	<div class="main">
        <cascader id="demo1"></cascader>
        <cascader id="demo2"></cascader>
		<cascader id="demo3"></cascader>
        <button class="layui-btn">提交</button>
	</div>
	<script>
		layui.config({
            base: './mods/ajaxCascader/'
            ,version: '1.0'
        });
        layui.use(['jquery','ajaxCascader'],function(){
            var $ = layui.jquery;
        	var cascader = layui.ajaxCascader;

            // Ajax传参模式
        	cascader.load({
                elem:'#demo1'                          
                ,value:0  
                // ,checkData:["520000000000", "520200000000", "520201000000"]
                ,getChildren:function(value,callback){  
                    var data = [];                  
                    $.ajax({                         
                        url:'https://open.gog.cn/appz/region/getRegion/'+value,
                        type:'get',
                        // async:false,
                        success:function(res){
                            data = res.data;
                            for(var i in data){
                                data[i].value = data[i].id;
                                data[i].label = data[i].name;
                                delete data[i].id;
                                delete data[i].name;
                                data[i].hasChild = true;
                            }
                            callback(data);
                        }
                    });
                }      
            });

            // 直接赋值模式
            cascader.load({
                elem:'#demo2'                        
                ,data:[
                    {value:123,label:456,children:[
                        {value:789,label:"子集"}
                    ]},
                    {value:240,label:"第一层"},
                    {value:250,label:"第一层"},
                    {value:260,label:"第一层"},
                    {value:280,label:"第一层"},
                ]
            });

            

            // 其他可选参数
            // width:250  //input框宽度
            // height:50  //input框高度
            // prop:{
            //     value:"value",     // 选择器要获取的字段名称
            //     label:"label",     // 显示时的名称
            //     children:'children' // 子集的名称定义
            // }
            // time:250    // 下拉菜单显示出来的时间
            // showlast:false  // 是否只显示选中的最后一级
            // checkData:['100','200'] // 回显数据

            $('.layui-btn').click(function(){
                cascader.load({
                    elem:'#demo3'
                    ,prop:{
                        value:'id',
                        label:'regionName',
                        children:'children'
                    }     
                    ,width:400                  
                    ,value:0                                                                       
                    ,getChildren:function(value,callback){   
                        var data = [];                  
                        $.ajax({                         
                            url:'http://10.10.7.214:8002/sysRegion/getByParentId/'+value,
                            type:'get',
                            success:function(res){
                                data = res.data;
                                for(let i in data){
                                    data[i].hasChild = true;
                                }
                                callback(data);
                            }
                        });
                    }      
                });
            })

            // 监听选中的事件
            cascader.on('click','#demo1',function(){

                // 获取当前已选中的数据,可单独使用
                console.log(cascader.getChooseData('#demo1'))
            });
        });
	</script>
</body>
</html>